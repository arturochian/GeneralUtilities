convertToDate <- function(x){
    require(lubridate)
    ## .x <- '1998Q1'

    x <- as.factor(x)
    levels <- levels(x)
    
    .converter <- function(.x){
        if (.x %like% "[0-9]+Q[0-9]+"){
            o <- .x %>>%
            stringr:::str_split('Q') %>>%
            (l ~ l[[1]])

            year <- o[[1]] %>>% as.numeric
            qrt <- o[[2]] %>>% as.numeric 

            date <- as.character(as.Date(paste0(year,'-',qrt*3,'-',1)) + months(1) - days(1))
            return(date)
        }
    }

    levelsm <- Vectorize(.converter)(levels) %>>% as.Date
    return(levelsm[x])
}
